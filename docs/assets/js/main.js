"use strict";const input=document.querySelector(".js-input"),searchBtn=document.querySelector(".js-search-btn"),resetBtn=document.querySelector(".js-reset-btn"),favList=document.querySelector(".js-favorites-list"),resetFavoritesBtn=document.querySelector(".js-reset-favorites-btn"),resultList=document.querySelector(".js-result-list"),headerMenu=document.querySelector(".js-header-menu"),favoritesSection=document.querySelector(".js-favorites-section"),resultsArrow=document.querySelector(".js-results-arrow"),body=document.querySelector(".js-body");let favorites=[],results=[];const classNames={hidden:"hidden",liResult:"js-li-results",resultsHeart:"anime__results--list--heart",resultsListElement:"anime__results--list--el",favorite:"favorite",favoritesListElement:"anime__favorites--list--el",favoritesListContainer:"anime__favorites--list--container",removeFavoritesIconJs:"js-remove-favorite",removeFavoritesIconCss:"anime__favorites--list--remove",btnOff:"anime__favorites--btn--off",btnOn:"anime__favorites--btn--on",overflowScroll:"overflow__scroll",overflowHidden:"overflow__hidden"},defaultImgUrl="https://via.placeholder.com/225x317/282F80/ffffff/?text=TV",coverImgsStyles={results:"height: 317px; width: 225px; background-size: cover",favorites:"height: 170px; width: 121px; background-size: cover"},favoriteHeartSrc="./assets/images/favorite.png";function getInputValue(){return input.value}function fetchData(){const e=getInputValue();fetch("https://api.jikan.moe/v3/search/anime?q="+e).then(e=>e.json()).then(e=>{results=[];for(const t of e.results)results.push(t);renderResults(results)})}function setDefaultImage(e,t){t.src=null===e?defaultImgUrl:e}function createCoverImgResult(e){const t=document.createElement("img");return setDefaultImage(e.image_url,t),t.style=coverImgsStyles.results,t.alt="Imagen de portada de "+e.title,t.title="Imagen de portada de "+e.title,t}function createParagraphResult(e){const t=document.createElement("p"),s=document.createTextNode(""+e.title);return t.appendChild(s),t}function createFavoritesImgResult(){const e=document.createElement("img");return e.src=favoriteHeartSrc,e.alt="Corazón de favorito",e.title="Corazón de favorito",e.classList.add(classNames.resultsHeart),e.classList.add(classNames.hidden),e}function appendElementsToResult(e,t){const s=createCoverImgResult(e),r=createParagraphResult(e),a=createFavoritesImgResult();t.appendChild(s),t.appendChild(r),t.appendChild(a)}function addClickListenerToResultLi(e){e.addEventListener("click",handleClickListElement)}function createLiResult(e){const t=document.createElement("li");return t.id=""+e.mal_id,t.classList.add(classNames.liResult),t.classList.add(classNames.resultsListElement),appendElementsToResult(e,t),addClickListenerToResultLi(t),t}function renderResults(e){resultList.innerHTML="";let t="";for(const s of e)t=createLiResult(s),resultList.appendChild(t);showHighlitedResults()}function toggleFavoriteClass(e){e.currentTarget.classList.toggle(classNames.favorite),e.currentTarget.childNodes[2].classList.toggle(classNames.hidden)}function showResultsArrow(){resultsArrow.classList.remove(classNames.hidden)}function hideResultsArrow(){resultsArrow.classList.add(classNames.hidden)}function createNewFavoriteObject(e){return{id:e.currentTarget.id,image_url:e.currentTarget.childNodes[0].currentSrc,title:e.currentTarget.childNodes[1].innerText}}function updateFavoritesList(e){const t=createNewFavoriteObject(e),s=e.currentTarget.id;if(void 0===favorites.find(e=>e.id===s))favorites.push(t);else{const e=favorites.findIndex(e=>e.id===s);favorites.splice(e,1)}}function createCoverFavorite(e){const t=document.createElement("img");return t.src=e.image_url,t.style=coverImgsStyles.favorites,t.alt="Imagen de portada de "+e.title,t.title="Imagen de portada de "+e.title,t}function createParagraphFavorite(e){const t=document.createElement("p"),s=document.createTextNode(""+e.title);return t.appendChild(s),t}function appendElementsToFavoriteDiv(e,t){const s=createCoverFavorite(e),r=createParagraphFavorite(e);return t.appendChild(s),t.appendChild(r),t}function createDivFavorite(e){const t=document.createElement("div");t.classList.add(classNames.favoritesListContainer);return appendElementsToFavoriteDiv(e,t)}function createRemoveIconFavorite(){const e=document.createElement("i");return e.classList.add("fas"),e.classList.add("fa-times-circle"),e.classList.add(classNames.removeFavoritesIconJs),e.classList.add(classNames.removeFavoritesIconCss),e}function appendElementsToFavoriteList(e,t){const s=createDivFavorite(e),r=createRemoveIconFavorite();t.appendChild(s),t.appendChild(r)}function createLiFavorite(e){const t=document.createElement("li");return t.id=""+e.id,t.classList.add(classNames.favoritesListElement),appendElementsToFavoriteList(e,t),t}function addListenerToRemoveIcons(){const e=document.querySelectorAll("."+classNames.removeFavoritesIconJs);for(const t of e)t.addEventListener("click",handleClickRemoveIcon);updateStatusResetBtn()}function saveFavoritesArray(){localStorage.setItem("favorites",JSON.stringify(favorites))}function renderFavorites(){favList.classList.remove(classNames.hidden),favList.innerHTML="";let e="";for(const t of favorites)e=createLiFavorite(t),favList.appendChild(e);addListenerToRemoveIcons(),saveFavoritesArray()}function addToFavorites(e){updateFavoritesList(e),renderFavorites()}function restoreSavedFavorites(){null!==localStorage.getItem("favorites")&&(favorites=JSON.parse(localStorage.getItem("favorites")),renderFavorites())}function deleteHighlitedResults(e){const t=e.currentTarget.parentNode.id,s=document.querySelectorAll("."+classNames.liResult);for(const e of s)t===e.id&&(e.classList.remove(classNames.favorite),e.childNodes[2].classList.add(classNames.hidden))}function removeFromFavorites(e){const t=e.currentTarget.parentNode.id,s=favorites.findIndex(e=>e.id===t);favorites.splice(s,1),deleteHighlitedResults(e),renderFavorites()}function deleteAllHighlitedResults(){const e=document.querySelectorAll("."+classNames.liResult);for(const t of e)t.classList.remove(classNames.favorite),t.childNodes[2].classList.add(classNames.hidden)}function removeAllFavorites(){favorites=[],localStorage.clear("favorites"),deleteAllHighlitedResults(),renderFavorites()}function showHighlitedResults(){const e=document.querySelectorAll("."+classNames.liResult);for(const t of e)for(const e of favorites)e.id===t.id&&(t.classList.add(classNames.favorite),t.childNodes[2].classList.remove(classNames.hidden))}function turnResetBtnOn(){resetFavoritesBtn.classList.remove(classNames.btnOff),resetFavoritesBtn.classList.add(classNames.btnOn)}function turnResetBtnOff(){resetFavoritesBtn.classList.add(classNames.btnOff),resetFavoritesBtn.classList.remove(classNames.btnOn)}function enableResetFavoritesBtn(){resetFavoritesBtn.disabled=!1,turnResetBtnOn()}function disableResetFavoritesBtn(){resetFavoritesBtn.disabled=!0,turnResetBtnOff()}function updateStatusResetBtn(){""===favList.innerHTML?disableResetFavoritesBtn():enableResetFavoritesBtn()}function resetResults(){input.value="",resultList.innerHTML=""}function toggleOverflowFavorites(){favoritesSection.classList.toggle(classNames.overflowScroll)}function removeOverflow(){body.classList.remove(classNames.overflowHidden),favoritesSection.classList.remove(classNames.overflowScroll)}function toggleOverflowBody(){body.classList.toggle(classNames.overflowHidden)}function toggleShowFavorites(){favoritesSection.classList.toggle(classNames.hidden)}function hideFavoritesSection(){favoritesSection.classList.add(classNames.hidden)}function toggleMenuRotation(){headerMenu.classList.toggle("rotate")}function scrollToTop(){window.scrollTo(0,0)}function handleClickSearch(e){e.preventDefault(),fetchData(),showResultsArrow()}function handleClickListElement(e){toggleFavoriteClass(e),enableResetFavoritesBtn(),addToFavorites(e)}function handleClickRemoveIcon(e){removeFromFavorites(e)}function handleClickReset(e){e.preventDefault(),resetResults(),hideResultsArrow()}function handleClickResetFavs(e){e.preventDefault(),removeOverflow(),removeAllFavorites(),toggleMenuRotation(),hideFavoritesSection()}function handleClickHeader(){toggleOverflowBody(),toggleOverflowFavorites(),toggleShowFavorites(),toggleMenuRotation(),scrollToTop()}function handleClickArrow(){scrollToTop()}restoreSavedFavorites(),updateStatusResetBtn(),searchBtn.addEventListener("click",handleClickSearch),resetBtn.addEventListener("click",handleClickReset),resetFavoritesBtn.addEventListener("click",handleClickResetFavs),headerMenu.addEventListener("click",handleClickHeader),resultsArrow.addEventListener("click",handleClickArrow);